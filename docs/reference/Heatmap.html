<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Heatmap — Heatmap • SeuratExtend</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Heatmap — Heatmap"><meta property="og:description" content="Generates a heatmap plot."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">SeuratExtend</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.2.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Vignettes
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/News.html">What's New in v1.1.0</a>
    </li>
    <li class="divider">
    <li>
      <a href="../articles/Visualization.html">Enhanced Visualization</a>
    </li>
    <li>
      <a href="../articles/GSEA.html">Geneset Enrichment Analysis (GSEA) </a>
    </li>
    <li>
      <a href="../articles/Trajectory.html">Trajectory and Pseudotime Analysis </a>
    </li>
    <li>
      <a href="../articles/SCENIC.html">SCENIC for Gene Regulatory Networks Analysis </a>
    </li>
    <li>
      <a href="../articles/Utilities.html">Utility Tools and Functions</a>
    </li>
  </ul></li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    scRNA-seq Course
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/single-cell-course/1.basic-R.html">1. Introduction to R</a>
    </li>
    <li>
      <a href="../articles/single-cell-course/2.Seurat.html">2. Basic Single-Cell Analysis Workflow</a>
    </li>
    <li>
      <a href="../articles/single-cell-course/3.Visualization.html">3. Advanced Visualization Techniques</a>
    </li>
    <li>
      <a href="../articles/single-cell-course/4.GSEA.html">4. Gene Set Enrichment Analysis</a>
    </li>
    <li>
      <a href="../articles/single-cell-course/5.Core-Enhancement.html">5. Core scRNA-seq Workflow Enhancements</a>
    </li>
    <li>
      <a href="../articles/single-cell-course/6.Advanced.html">6. Advanced Methods (Part 1)</a>
    </li>
    <li>
      <a href="../articles/single-cell-course/6.Advanced-2.html">7. Advanced Methods (Part 2)</a>
    </li>
  </ul></li>
<li>
  <a href="../articles/FAQ.html">FAQ</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"></ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Heatmap</h1>
    
    <div class="hidden name"><code>Heatmap.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Generates a heatmap plot.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">Heatmap</span><span class="op">(</span></span>
<span>  <span class="va">score</span>,</span>
<span>  color_scheme <span class="op">=</span> <span class="st">"BuRd"</span>,</span>
<span>  center_color <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  border_color <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  lab_fill <span class="op">=</span> <span class="st">"score"</span>,</span>
<span>  angle <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  hjust <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  vjust <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  legend_position <span class="op">=</span> <span class="st">"right"</span>,</span>
<span>  y_text_position <span class="op">=</span> <span class="st">"right"</span>,</span>
<span>  feature_text_subset <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  segment.width <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2.5</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>  segment.size <span class="op">=</span> <span class="fl">0.2</span>,</span>
<span>  text.spacing <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  text.size <span class="op">=</span> <span class="fl">2.5</span>,</span>
<span>  hide_axis_line <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  plot.margin <span class="op">=</span> <span class="fu">margin</span><span class="op">(</span>t <span class="op">=</span> <span class="fl">5.5</span>, r <span class="op">=</span> <span class="fl">5.5</span>, b <span class="op">=</span> <span class="fl">5.5</span>, l <span class="op">=</span> <span class="fl">5.5</span><span class="op">)</span>,</span>
<span>  expand_limits_x <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  facet_col <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  facet_row <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  panel.spacing <span class="op">=</span> <span class="fu">unit</span><span class="op">(</span><span class="fl">5</span>, <span class="st">"pt"</span><span class="op">)</span>,</span>
<span>  strip.placement <span class="op">=</span> <span class="st">"outside"</span>,</span>
<span>  ncol <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  nrow <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>score</dt>
<dd><p>A matrix for input, for instance, one generated using the CalcStats function.</p></dd>


<dt>color_scheme</dt>
<dd><p>Specifies the color gradient for the heatmap visualization.
  This parameter accepts multiple input formats to provide flexibility in defining color schemes:</p>
<p>- Predefined color schemes from the `viridis` package ("A" to "H").</p>
<p>- Named vector with keys "low", "mid", and "high" for three-point gradients. Example: `c(low = muted("blue"), mid = "white", high = muted("red"))`.</p>
<p>- Two-point gradient with keys "low" and "high". Example: `c(low = "lightblue", high = "red")`.</p>
<p>- RColorBrewer sequential palettes: "Blues", "BuGn", "BuPu", "GnBu", "Greens", "Greys", "Oranges", "OrRd", "PuBu", "PuBuGn", "PuRd", "Purples", "RdPu", "Reds", "YlGn", "YlGnBu", "YlOrBr", "YlOrRd".</p>
<p>- RColorBrewer diverging palettes: "BrBG", "PiYG", "PRGn", "PuOr", "RdBu", "RdGy", "RdYlBu", "RdYlGn", "Spectral".</p>
<p>- Custom diverging palettes: "GnYlRd", "BuYlRd", "GyRd", "BuRd", "PuOr".</p>
<p>- Append "-rev" to any RColorBrewer palette name to reverse the color order. Example: "RdBu-rev".</p>
<p>- Custom color gradient using a vector of colors.</p></dd>


<dt>center_color</dt>
<dd><p>Logical or NULL. Determines whether the color scale should be centered at zero.
If TRUE, the color scale will be centered at zero, with the midpoint color representing zero.
If FALSE, the color scale will span the full range of the data without centering.
If NULL (default), it will automatically determine based on the color scheme:
TRUE for diverging color palettes, FALSE for sequential palettes or custom color schemes.
This is particularly useful for visualizing data with both positive and negative values,
such as z-scores or log fold changes.</p></dd>


<dt>border_color</dt>
<dd><p>Color for the tile borders. Default: NULL.</p></dd>


<dt>lab_fill</dt>
<dd><p>Label for the color. Default: 'score'.</p></dd>


<dt>angle</dt>
<dd><p>Angle of x-axis labels. Default: NULL (auto-determined).</p></dd>


<dt>hjust</dt>
<dd><p>Horizontal justification of x-axis labels. Default: NULL (auto-determined).</p></dd>


<dt>vjust</dt>
<dd><p>Vertical justification of x-axis labels. Default: NULL (auto-determined).</p></dd>


<dt>legend_position</dt>
<dd><p>Position of the figure legend. Default: 'right'.</p></dd>


<dt>y_text_position</dt>
<dd><p>Position of the row name text. Default: 'right'</p></dd>


<dt>feature_text_subset</dt>
<dd><p>A subset of feature names to be shown. Useful when there are many features. Default: NULL.</p></dd>


<dt>segment.width</dt>
<dd><p>Adjust the width ratio of the line connecting heatmap rows and feature text. Only effective when `feature_text_subset` is set. Default: c(1, 2.5, 1).</p></dd>


<dt>segment.size</dt>
<dd><p>Thickness of the line connecting heatmap rows and feature text. Only effective when `feature_text_subset` is set. Default: 0.2.</p></dd>


<dt>text.spacing</dt>
<dd><p>Spacing between feature texts. Only effective when `feature_text_subset` is set. Default: 2.</p></dd>


<dt>text.size</dt>
<dd><p>Font size of the feature text. Only effective when `feature_text_subset` is set. Default: 2.5.</p></dd>


<dt>hide_axis_line</dt>
<dd><p>Whether to hide the axis line or not. Default: TRUE.</p></dd>


<dt>plot.margin</dt>
<dd><p>Adjusts the space around the plot to prevent text labels from being cut off. This is particularly useful when axis names are too long and may extend beyond the plot boundaries. The margin is defined for top (t), right (r), bottom (b), and left (l) edges of the plot area.
To increase the left margin and provide more space for the first name on the x-axis, increase the `l` value. Default: `margin(t = 5.5, r = 5.5, b = 5.5, l = 5.5)` in grid units.</p></dd>


<dt>expand_limits_x</dt>
<dd><p>This parameter is softly deprecated in favor of using `plot.margin`.
Previously used to increase the space on the left side of the plot by adjusting the x-axis limits. It is still available for backward compatibility but its use is not recommended. Default: NULL.</p></dd>


<dt>facet_col</dt>
<dd><p>Vector or factor to split the heatmap columns. Default: NULL.</p></dd>


<dt>facet_row</dt>
<dd><p>Vector or factor to split the heatmap rows. Default: NULL.</p></dd>


<dt>panel.spacing</dt>
<dd><p>Spacing between panels when rows or columns are split. Default: unit(5, "pt").</p></dd>


<dt>strip.placement</dt>
<dd><p>Placement of panel names when rows or columns are split. Default: 'outside'.</p></dd>


<dt>ncol</dt>
<dd><p>Number of columns when either `facet_col` or `facet_row` is not NULL, wrapping the heatmap. Default: NULL.</p></dd>


<dt>nrow</dt>
<dd><p>Number of rows when either `facet_col` or `facet_row` is not NULL, wrapping the heatmap. Default: NULL.</p></dd>


<dt>...</dt>
<dd><p>Additional parameters passed to the `theme` function of ggplot2.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>A ggplot object.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>For more detailed usage, see the examples provided.</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="co"># First, create a matrix using the CalcStats function.</span></span>
<span><span class="va">genes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://satijalab.github.io/seurat-object/reference/VariableFeatures.html" class="external-link">VariableFeatures</a></span><span class="op">(</span><span class="va">pbmc</span><span class="op">)</span></span>
<span><span class="va">toplot</span> <span class="op">&lt;-</span> <span class="fu"><a href="CalcStats.html">CalcStats</a></span><span class="op">(</span><span class="va">pbmc</span>, features <span class="op">=</span> <span class="va">genes</span>, method <span class="op">=</span> <span class="st">"zscore"</span>, order <span class="op">=</span> <span class="st">"p"</span>, n <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Generate a basic heatmap.</span></span>
<span><span class="fu">Heatmap</span><span class="op">(</span><span class="va">toplot</span>, lab_fill <span class="op">=</span> <span class="st">"zscore"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Modify the color theme to range from white to dark green.</span></span>
<span><span class="fu">Heatmap</span><span class="op">(</span><span class="va">toplot</span>, lab_fill <span class="op">=</span> <span class="st">"zscore"</span>, color_scheme <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"white"</span>, <span class="fu">muted</span><span class="op">(</span><span class="st">"green"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Use a color theme that transitions from dark blue to light yellow (centered at 0) to dark red.</span></span>
<span><span class="fu">Heatmap</span><span class="op">(</span><span class="va">toplot</span>, lab_fill <span class="op">=</span> <span class="st">"zscore"</span>, color_scheme <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  low <span class="op">=</span> <span class="fu">muted</span><span class="op">(</span><span class="st">"blue"</span><span class="op">)</span>,</span>
<span>  mid <span class="op">=</span> <span class="st">"lightyellow"</span>,</span>
<span>  high <span class="op">=</span> <span class="fu">muted</span><span class="op">(</span><span class="st">"red"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Employ the viridis color theme, options include A, B, C, D, or E.</span></span>
<span><span class="fu">Heatmap</span><span class="op">(</span><span class="va">toplot</span>, lab_fill <span class="op">=</span> <span class="st">"zscore"</span>, color_scheme <span class="op">=</span> <span class="st">"A"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Adjust the left margin to ensure the x-axis labels fit within the plot boundaries</span></span>
<span><span class="fu">Heatmap</span><span class="op">(</span><span class="va">toplot</span>, lab_fill <span class="op">=</span> <span class="st">"zscore"</span>, plot.margin <span class="op">=</span> <span class="fu">margin</span><span class="op">(</span>l <span class="op">=</span> <span class="fl">30</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Construct a dense matrix with data for 500 genes.</span></span>
<span><span class="va">toplot2</span> <span class="op">&lt;-</span> <span class="fu"><a href="CalcStats.html">CalcStats</a></span><span class="op">(</span><span class="va">pbmc</span>, features <span class="op">=</span> <span class="va">genes</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">500</span><span class="op">]</span>, method <span class="op">=</span> <span class="st">"zscore"</span>, order <span class="op">=</span> <span class="st">"p"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Display only a subset of gene names.</span></span>
<span><span class="fu">Heatmap</span><span class="op">(</span><span class="va">toplot2</span>, lab_fill <span class="op">=</span> <span class="st">"zscore"</span>, feature_text_subset <span class="op">=</span> <span class="va">genes</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">20</span><span class="op">]</span>, expand_limits_x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.5</span>, <span class="fl">11</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Divide the heatmap into rows based on gene groups.</span></span>
<span><span class="va">gene_groups</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"group1"</span>, <span class="st">"group2"</span>, <span class="st">"group3"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">toplot2</span><span class="op">)</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu">Heatmap</span><span class="op">(</span><span class="va">toplot2</span>, lab_fill <span class="op">=</span> <span class="st">"zscore"</span>, facet_row <span class="op">=</span> <span class="va">gene_groups</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span>axis.text.y <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span></span></code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Yichao Hua.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

