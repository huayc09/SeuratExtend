<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Seurat to AnnData Conversion and Management Tools — adata.Load • SeuratExtend</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Seurat to AnnData Conversion and Management Tools — adata.Load"><meta property="og:description" content="This documentation encompasses a suite of functions designed to facilitate the conversion and management of data between Seurat objects and AnnData structures. The functions cover the entire workflow from initial conversion of Seurat objects to Loom or AnnData formats, adding supplementary data like dimension reductions and metadata, and saving or loading these objects for further analysis."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">SeuratExtend</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.2.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Vignettes
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/News.html">What's New in v1.1.0</a>
    </li>
    <li class="divider">
    <li>
      <a href="../articles/Visualization.html">Enhanced Visualization</a>
    </li>
    <li>
      <a href="../articles/GSEA.html">Geneset Enrichment Analysis (GSEA) </a>
    </li>
    <li>
      <a href="../articles/Trajectory.html">Trajectory and Pseudotime Analysis </a>
    </li>
    <li>
      <a href="../articles/SCENIC.html">SCENIC for Gene Regulatory Networks Analysis </a>
    </li>
    <li>
      <a href="../articles/Utilities.html">Utility Tools and Functions</a>
    </li>
  </ul></li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    scRNA-seq Course
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/single-cell-course/1.basic-R.html">1. Introduction to R</a>
    </li>
    <li>
      <a href="../articles/single-cell-course/2.Seurat.html">2. Basic Single-Cell Analysis Workflow</a>
    </li>
    <li>
      <a href="../articles/single-cell-course/3.Visualization.html">3. Advanced Visualization Techniques</a>
    </li>
    <li>
      <a href="../articles/single-cell-course/4.GSEA.html">4. Gene Set Enrichment Analysis</a>
    </li>
    <li>
      <a href="../articles/single-cell-course/5.Core-Enhancement.html">5. Core scRNA-seq Workflow Enhancements</a>
    </li>
    <li>
      <a href="../articles/single-cell-course/6.Advanced.html">6. Advanced Methods (Part 1)</a>
    </li>
    <li>
      <a href="../articles/single-cell-course/6.Advanced-2.html">7. Advanced Methods (Part 2)</a>
    </li>
  </ul></li>
<li>
  <a href="../articles/FAQ.html">FAQ</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"></ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Seurat to AnnData Conversion and Management Tools</h1>
    
    <div class="hidden name"><code>adata.Load.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This documentation encompasses a suite of functions designed to facilitate the conversion and management of data between Seurat objects and AnnData structures. The functions cover the entire workflow from initial conversion of Seurat objects to Loom or AnnData formats, adding supplementary data like dimension reductions and metadata, and saving or loading these objects for further analysis.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">adata.Load</span><span class="op">(</span><span class="va">adata.path</span>, conda_env <span class="op">=</span> <span class="st">"seuratextend"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">adata.Save</span><span class="op">(</span><span class="va">adata.path</span>, conda_env <span class="op">=</span> <span class="st">"seuratextend"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">adata.AddDR</span><span class="op">(</span></span>
<span>  <span class="va">seu</span>,</span>
<span>  dr <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  prefix <span class="op">=</span> <span class="st">"X_"</span>,</span>
<span>  postfix <span class="op">=</span> <span class="st">""</span>,</span>
<span>  scv.graph <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  load.adata <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  save.adata <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  conda_env <span class="op">=</span> <span class="st">"seuratextend"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">adata.AddMetadata</span><span class="op">(</span></span>
<span>  <span class="va">seu</span>,</span>
<span>  <span class="va">col</span>,</span>
<span>  load.adata <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  save.adata <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  conda_env <span class="op">=</span> <span class="st">"seuratextend"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">adata.LoadLoom</span><span class="op">(</span><span class="va">loompath</span>, save.adata <span class="op">=</span> <span class="cn">NULL</span>, conda_env <span class="op">=</span> <span class="st">"seuratextend"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">Seu2Adata</span><span class="op">(</span></span>
<span>  <span class="va">seu</span>,</span>
<span>  add.normdata <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  save.adata <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  conda_env <span class="op">=</span> <span class="st">"seuratextend"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">Seu2Loom</span><span class="op">(</span></span>
<span>  <span class="va">seu</span>,</span>
<span>  <span class="va">filename</span>,</span>
<span>  add.normdata <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  add.metadata <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  layers <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  overwrite <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>adata.path</dt>
<dd><p>Path to the AnnData (.h5ad) file where the data is to be saved or from which data is to be loaded.</p></dd>


<dt>conda_env</dt>
<dd><p>Name of the Conda environment where the necessary Python libraries are installed. This environment is used to run Python code from R, bridging Seurat and AnnData functionalities. Default: 'seuratextend'.</p></dd>


<dt>seu</dt>
<dd><p>The Seurat object from which data is being converted or managed.</p></dd>


<dt>dr</dt>
<dd><p>Specifies which dimension reductions from the Seurat object should be transferred to the AnnData object. If NULL, all available reductions are included. Default: NULL.</p></dd>


<dt>prefix</dt>
<dd><p>A prefix to add to the dimension reduction names when importing them into the AnnData object's 'obsm' attribute. This helps in differentiating various data types and maintaining order within the dataset. Default: 'X_'.</p></dd>


<dt>postfix</dt>
<dd><p>A postfix to add to the dimension reduction names when importing them into the AnnData object's 'obsm' attribute.</p></dd>


<dt>scv.graph</dt>
<dd><p>Optional; a boolean indicating whether to calculate the velocity graph after importing dimension reduction data. This is useful for kinetic analyses in single-cell studies. Default: FALSE.</p></dd>


<dt>load.adata</dt>
<dd><p>Optional; path to a previously saved AnnData object to be loaded. Default: NULL. Useful for resuming analyses or integrating additional data without repeating preprocessing steps.</p></dd>


<dt>save.adata</dt>
<dd><p>Optional; specifies the file path where the AnnData object should be saved after processing. The file will be saved in the .h5ad format. This parameter facilitates easy storage of processed data.</p></dd>


<dt>col</dt>
<dd><p>The name of the metadata column in the Seurat object that needs to be transferred to the AnnData object.</p></dd>


<dt>loompath</dt>
<dd><p>Path to the loom file that needs to be loaded into an AnnData object.</p></dd>


<dt>add.normdata</dt>
<dd><p>Boolean indicating whether to also include the normalized gene expression matrix in the loom file.</p></dd>


<dt>filename</dt>
<dd><p>Filename for the loom file to be created or accessed. It specifies where the loom file will be stored or is stored, which is essential for data conversion tasks.</p></dd>


<dt>add.metadata</dt>
<dd><p>Boolean indicating whether to also include the meta.data in the loom file.</p></dd>


<dt>layers</dt>
<dd><p>Optional; a list of additional matrices to include as layers in the loom file, such as velocyto's spliced/unspliced matrices. Each matrix must match the transposed dimensions of the Seurat object (row for cells and columns for genes). Default: NULL.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>Depending on the function called, this suite returns either a modified Seurat object or an AnnData object, or it may perform save/load operations without returning an object. Specifically:</p>


<p>- `Seu2Adata` and `Seu2Loom` convert Seurat objects to AnnData and Loom formats, respectively.</p>


<p>- `adata.LoadLoom` loads a Loom file into an AnnData object.</p>


<p>- `adata.AddDR` and `adata.AddMetadata` enrich an AnnData object with additional dimension reduction data and metadata from a Seurat object.</p>


<p>- `adata.Save` and `adata.Load` handle saving to and loading from disk operations for AnnData objects.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>These functions are designed to ensure seamless interoperability between R, used primarily for Seurat, and Python, used for AnnData via the reticulate package:</p>
<p>- `Seu2Adata` directly converts a Seurat object into an AnnData object, optionally adding normalized data and saving the result.</p>
<p>- `Seu2Loom` converts a Seurat object into a Loom file, allowing for intermediate storage or further conversion.</p>
<p>- `adata.LoadLoom` initiates an AnnData object from a Loom file, useful for integrating with Python-based analyses.</p>
<p>- `adata.AddDR` appends dimension reduction results from Seurat to an AnnData object, essential for preserving comprehensive analytical context.</p>
<p>- `adata.AddMetadata` transfers additional metadata from Seurat to AnnData, facilitating enriched data analyses.</p>
<p>- `adata.Save` provides functionality to save AnnData objects to disk, securing data for future use.</p>
<p>- `adata.Load` retrieves AnnData objects from disk, ensuring continuity of analysis across sessions.</p>
<p>These tools are integral for researchers employing hybrid workflows that leverage the strengths of both Seurat and Scanpy/AnnData environments, supporting a wide range of computational tasks from data preprocessing to advanced analyses.</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://satijalab.org/seurat" class="external-link">Seurat</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">SeuratExtend</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rstudio.github.io/reticulate/" class="external-link">reticulate</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Convert Seurat object to loom file and save it locally</span></span>
<span><span class="va">pbmc_loom_path</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">"pbmc3k_small.loom"</span><span class="op">)</span></span>
<span><span class="fu">Seu2Loom</span><span class="op">(</span><span class="va">pbmc</span>, filename <span class="op">=</span> <span class="va">pbmc_loom_path</span>, add.normdata <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Load the loom file into an AnnData object</span></span>
<span><span class="fu">adata.LoadLoom</span><span class="op">(</span>loompath <span class="op">=</span> <span class="va">pbmc_loom_path</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Use reticulate to execute Python code and print the AnnData object details</span></span>
<span><span class="fu"><a href="https://rstudio.github.io/reticulate/reference/py_run.html" class="external-link">py_run_string</a></span><span class="op">(</span><span class="st">"print(adata)"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Add dimension reduction data from Seurat to AnnData</span></span>
<span><span class="fu">adata.AddDR</span><span class="op">(</span><span class="va">pbmc</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rstudio.github.io/reticulate/reference/py_run.html" class="external-link">py_run_string</a></span><span class="op">(</span><span class="st">"print(adata)"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Directly convert Seurat object to AnnData object including all processing steps</span></span>
<span><span class="fu">Seu2Adata</span><span class="op">(</span><span class="va">pbmc</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Update AnnData with new metadata from Seurat</span></span>
<span><span class="va">pbmc</span><span class="op">$</span><span class="va">cluster2</span> <span class="op">&lt;-</span> <span class="va">pbmc</span><span class="op">$</span><span class="va">cluster</span></span>
<span><span class="fu">adata.AddMetadata</span><span class="op">(</span><span class="va">pbmc</span>, col <span class="op">=</span> <span class="st">"cluster2"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rstudio.github.io/reticulate/reference/py_run.html" class="external-link">py_run_string</a></span><span class="op">(</span><span class="st">"print(adata)"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Save the AnnData object to a local file</span></span>
<span><span class="va">pbmc_adata_path</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">"pbmc3k_small.h5ad"</span><span class="op">)</span></span>
<span><span class="fu">adata.Save</span><span class="op">(</span><span class="va">pbmc_adata_path</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Load an existing AnnData object from file</span></span>
<span><span class="fu">adata.Load</span><span class="op">(</span><span class="va">pbmc_adata_path</span><span class="op">)</span></span>
<span></span></code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Yichao Hua.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

