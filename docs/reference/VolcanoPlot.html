<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Create a Volcano Plot Comparing Two Groups — VolcanoPlot • SeuratExtend</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Create a Volcano Plot Comparing Two Groups — VolcanoPlot"><meta property="og:description" content="Creates a volcano plot to visualize differential expression or other comparative analyses
between two groups. The plot displays a measure of change (typically log fold change)
on the x-axis versus a measure of significance (typically -log10 p-value) on the y-axis.
Points are colored based on their significance levels, and top features in both
up- and down-regulated directions are labeled."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">SeuratExtend</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.2.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Vignettes
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/News.html">What's New in v1.1.0</a>
    </li>
    <li class="divider">
    <li>
      <a href="../articles/Visualization.html">Enhanced Visualization</a>
    </li>
    <li>
      <a href="../articles/GSEA.html">Geneset Enrichment Analysis (GSEA) </a>
    </li>
    <li>
      <a href="../articles/Trajectory.html">Trajectory and Pseudotime Analysis </a>
    </li>
    <li>
      <a href="../articles/SCENIC.html">SCENIC for Gene Regulatory Networks Analysis </a>
    </li>
    <li>
      <a href="../articles/Utilities.html">Utility Tools and Functions</a>
    </li>
  </ul></li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    scRNA-seq Course
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/single-cell-course/1.basic-R.html">1. Introduction to R</a>
    </li>
    <li>
      <a href="../articles/single-cell-course/2.Seurat.html">2. Basic Single-Cell Analysis Workflow</a>
    </li>
    <li>
      <a href="../articles/single-cell-course/3.Visualization.html">3. Advanced Visualization Techniques</a>
    </li>
    <li>
      <a href="../articles/single-cell-course/4.GSEA.html">4. Gene Set Enrichment Analysis</a>
    </li>
    <li>
      <a href="../articles/single-cell-course/5.Core-Enhancement.html">5. Core scRNA-seq Workflow Enhancements</a>
    </li>
    <li>
      <a href="../articles/single-cell-course/6.Advanced.html">6. Advanced Methods (Part 1)</a>
    </li>
    <li>
      <a href="../articles/single-cell-course/6.Advanced-2.html">7. Advanced Methods (Part 2)</a>
    </li>
  </ul></li>
<li>
  <a href="../articles/FAQ.html">FAQ</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"></ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Create a Volcano Plot Comparing Two Groups</h1>
    
    <div class="hidden name"><code>VolcanoPlot.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Creates a volcano plot to visualize differential expression or other comparative analyses
between two groups. The plot displays a measure of change (typically log fold change)
on the x-axis versus a measure of significance (typically -log10 p-value) on the y-axis.
Points are colored based on their significance levels, and top features in both
up- and down-regulated directions are labeled.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">VolcanoPlot</span><span class="op">(</span><span class="va">object</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for Seurat</span></span>
<span><span class="fu">VolcanoPlot</span><span class="op">(</span></span>
<span>  <span class="va">seu</span>,</span>
<span>  features <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">seu</span><span class="op">)</span>,</span>
<span>  group.by <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  cell <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  cells <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  slot <span class="op">=</span> <span class="st">"data"</span>,</span>
<span>  assay <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  priority <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"expr"</span>, <span class="st">"none"</span><span class="op">)</span>,</span>
<span>  ident.1 <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  ident.2 <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  exp.transform <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  x <span class="op">=</span> <span class="st">"logFC"</span>,</span>
<span>  y <span class="op">=</span> <span class="st">"p"</span>,</span>
<span>  x.threshold <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  y.threshold <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  x.quantile <span class="op">=</span> <span class="fl">0.99</span>,</span>
<span>  y.quantile <span class="op">=</span> <span class="fl">0.99</span>,</span>
<span>  top.n <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  color <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"grey20"</span>, <span class="st">"grey50"</span>, <span class="st">"red3"</span><span class="op">)</span>,</span>
<span>  title <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  log.base <span class="op">=</span> <span class="st">"e"</span>,</span>
<span>  pseudocount <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for default</span></span>
<span><span class="fu">VolcanoPlot</span><span class="op">(</span></span>
<span>  <span class="va">matr</span>,</span>
<span>  <span class="va">f</span>,</span>
<span>  ident.1 <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  ident.2 <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  exp.transform <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  x <span class="op">=</span> <span class="st">"logFC"</span>,</span>
<span>  y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"p"</span>, <span class="st">"tscore"</span><span class="op">)</span>,</span>
<span>  x.threshold <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  y.threshold <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  x.quantile <span class="op">=</span> <span class="fl">0.99</span>,</span>
<span>  y.quantile <span class="op">=</span> <span class="fl">0.99</span>,</span>
<span>  top.n <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  color <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"grey20"</span>, <span class="st">"grey50"</span>, <span class="st">"red3"</span><span class="op">)</span>,</span>
<span>  title <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  log.base <span class="op">=</span> <span class="st">"e"</span>,</span>
<span>  pseudocount <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>seu</dt>
<dd><p>A Seurat object. Only applicable when using the Seurat method.</p></dd>


<dt>features</dt>
<dd><p>Features to be plotted, which can include gene expression or any other data that can be retrieved using the `FetchData()` function. Only applicable for the Seurat method.</p></dd>


<dt>group.by</dt>
<dd><p>A variable from `meta.data` for grouping, or a character vector of the same length as the number of cells. Only applicable for the Seurat method.</p></dd>


<dt>cell</dt>
<dd><p>Cell identifiers to be used in the plot. Defaults to all cells. Only applicable for the Seurat method.</p></dd>


<dt>cells</dt>
<dd><p>Alternative parameter name for cell identifiers. Same functionality as 'cell'. Defaults to all cells.</p></dd>


<dt>slot</dt>
<dd><p>Slot from which to retrieve feature data. Only applicable for the Seurat method.</p></dd>


<dt>assay</dt>
<dd><p>Name of the assay to use. If not specified, the active assay will be used. Only applicable for the Seurat method.</p></dd>


<dt>priority</dt>
<dd><p>If set to "expr", the function will fetch data from the expression matrix rather than `meta.data`. Only applicable for the Seurat method.</p></dd>


<dt>ident.1</dt>
<dd><p>The primary identity class. If not specified, the first class will be used.</p></dd>


<dt>ident.2</dt>
<dd><p>An optional secondary identity class for comparison. If NULL, comparisons will be made against all other cells.</p></dd>


<dt>exp.transform</dt>
<dd><p>Indicates whether to transform data using `expm1`. This is particularly useful when calculating the log fold change of normalized gene counts. Defaults to TRUE for Seurat object input and FALSE for matrix input.</p></dd>


<dt>x</dt>
<dd><p>A character specifying the statistic for x-axis. Must be one of c("logFC", "tscore"). Defaults to "logFC".</p></dd>


<dt>y</dt>
<dd><p>A character specifying the statistic for y-axis. Must be one of c("p", "tscore"). Defaults to "p".</p></dd>


<dt>x.threshold</dt>
<dd><p>Threshold for the x-axis statistic. Features beyond this threshold will be labeled. Defaults to NULL (auto-detected).</p></dd>


<dt>y.threshold</dt>
<dd><p>Threshold for the y-axis statistic. Features beyond this threshold will be labeled. Defaults to NULL (auto-detected).</p></dd>


<dt>x.quantile</dt>
<dd><p>Quantile threshold for x-axis (between 0 and 1) used when auto-calculating x.threshold. Defaults to 0.99.</p></dd>


<dt>y.quantile</dt>
<dd><p>Quantile threshold for y-axis (between 0 and 1) used when auto-calculating y.threshold. Defaults to 0.99.</p></dd>


<dt>top.n</dt>
<dd><p>Number of top features to label. Defaults to 10.</p></dd>


<dt>color</dt>
<dd><p>A vector of three colors specifying the color scheme: c(center_color, non_significant_color, significant_color).
Defaults to c("grey20", "grey50", "red3"). The first color is used for points near zero (below thresholds),
the second for points passing single threshold, and the third for points passing both thresholds.</p></dd>


<dt>title</dt>
<dd><p>Title of the plot. Defaults to NULL.</p></dd>


<dt>log.base</dt>
<dd><p>The base for logarithmic calculations when using logFC. Can be "e" (natural logarithm, default), "2" (log2), or "10" (log10).</p></dd>


<dt>pseudocount</dt>
<dd><p>Pseudocount to be added to the data before transformation. Only applicable for the Seurat method.</p></dd>


<dt>matr</dt>
<dd><p>A matrix or data frame where rows represent features and columns represent cells.</p></dd>


<dt>f</dt>
<dd><p>A factor or vector indicating the identity of each cell. The length should match the number of columns in `matr`.</p></dd>

</dl></div>
    <div id="details">
    <h2>Details</h2>
    <p>The function supports both Seurat objects and raw matrices as input. For Seurat objects,
it automatically handles data extraction and can work with any features available in the
object. The plot uses automatic threshold detection based on data quantiles if thresholds
are not manually specified.</p>
<p>The visualization employs a three-color scheme:
* Points below both thresholds are colored using the first specified color
* Points passing either x or y threshold (but not both) use the second color
* Points passing both thresholds use the third color</p>
<p>The function automatically labels the top features in both directions (positive and
negative changes) that pass both thresholds. The number of features to label can be
controlled using the `top.n` parameter.</p>
<p>When `y = "p"`, the y-axis displays -log10 transformed p-values.</p>
<p>By default, log fold change (logFC) calculations use natural logarithm (base e).
You can specify a different logarithm base using the `log.base` parameter.
Common choices include "e" (natural log, default), "2" (log2), or "10" (log10).</p>
<p>When calculating logFC, a pseudocount is added to both the numerator and denominator 
(i.e., log((mean(x[group1]+pseudocount)/(mean(x[group2]+pseudocount)))) to prevent 
issues with zero values and to stabilize calculations for low expression values. 
By default, pseudocount=1 is used for most data types. For data with values 
constrained between 0-1 (like AUCell scores), pseudocount=0.01 is automatically 
applied unless manually specified otherwise.</p>
<p>For Seurat objects, when calculating gene expression logFC values, the normalized data 
undergoes expm1 transformation before calculation (controlled by exp.transform=TRUE 
by default). This ensures consistency with Seurat's FindMarkers function. To disable 
this transformation, set exp.transform=FALSE. This behavior only applies when using 
gene expression data from a Seurat object.</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="co"># Basic usage with a Seurat object</span></span>
<span><span class="fu">VolcanoPlot</span><span class="op">(</span><span class="va">pbmc</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Compare specific cell types with customized thresholds</span></span>
<span><span class="fu">VolcanoPlot</span><span class="op">(</span></span>
<span>  <span class="va">pbmc</span>,</span>
<span>  ident.1 <span class="op">=</span> <span class="st">"B cell"</span>,</span>
<span>  ident.2 <span class="op">=</span> <span class="st">"CD8 T cell"</span>,</span>
<span>  x.threshold <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  y.threshold <span class="op">=</span> <span class="fl">5</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Customize appearance</span></span>
<span><span class="fu">VolcanoPlot</span><span class="op">(</span></span>
<span>  <span class="va">pbmc</span>,</span>
<span>  ident.1 <span class="op">=</span> <span class="st">"B cell"</span>,</span>
<span>  ident.2 <span class="op">=</span> <span class="st">"CD8 T cell"</span>,</span>
<span>  x.quantile <span class="op">=</span> <span class="fl">0.99</span>,    <span class="co"># Less stringent x threshold</span></span>
<span>  y.quantile <span class="op">=</span> <span class="fl">0.95</span>,    <span class="co"># More stringent y threshold</span></span>
<span>  top.n <span class="op">=</span> <span class="fl">5</span>,            <span class="co"># Label fewer genes</span></span>
<span>  color <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"grey20"</span>, <span class="st">"grey70"</span>, <span class="st">"darkred"</span><span class="op">)</span>  <span class="co"># Custom colors</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Use t-score instead of p-value for y-axis</span></span>
<span><span class="fu">VolcanoPlot</span><span class="op">(</span></span>
<span>  <span class="va">pbmc</span>,</span>
<span>  ident.1 <span class="op">=</span> <span class="st">"B cell"</span>,</span>
<span>  ident.2 <span class="op">=</span> <span class="st">"CD8 T cell"</span>,</span>
<span>  y <span class="op">=</span> <span class="st">"tscore"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Use log2 instead of natural logarithm for fold change calculations</span></span>
<span><span class="fu">VolcanoPlot</span><span class="op">(</span></span>
<span>  <span class="va">pbmc</span>,</span>
<span>  ident.1 <span class="op">=</span> <span class="st">"B cell"</span>,</span>
<span>  ident.2 <span class="op">=</span> <span class="st">"CD8 T cell"</span>,</span>
<span>  log.base <span class="op">=</span> <span class="st">"2"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Direct usage with a matrix</span></span>
<span><span class="va">pbmc</span> <span class="op">&lt;-</span> <span class="fu"><a href="GeneSetAnalysis.html">GeneSetAnalysisGO</a></span><span class="op">(</span><span class="va">pbmc</span>, parent <span class="op">=</span> <span class="st">"immune_system_process"</span>, spe <span class="op">=</span> <span class="st">"human"</span><span class="op">)</span></span>
<span><span class="va">matr</span> <span class="op">&lt;-</span> <span class="va">pbmc</span><span class="op">@</span><span class="va">misc</span><span class="op">$</span><span class="va">AUCell</span><span class="op">$</span><span class="va">GO</span><span class="op">$</span><span class="va">immune_system_process</span></span>
<span></span>
<span><span class="co"># Generate a volcano plot comparing B cell with CD8 T cells.</span></span>
<span><span class="fu">VolcanoPlot</span><span class="op">(</span></span>
<span>  <span class="va">matr</span>,</span>
<span>  f <span class="op">=</span> <span class="va">pbmc</span><span class="op">$</span><span class="va">cluster</span>,</span>
<span>  ident.1 <span class="op">=</span> <span class="st">"B cell"</span>,</span>
<span>  ident.2 <span class="op">=</span> <span class="st">"CD8 T cell"</span>,</span>
<span>  x.quantile <span class="op">=</span> <span class="fl">0.8</span>,</span>
<span>  y.quantile <span class="op">=</span> <span class="fl">0.8</span>,</span>
<span>  top.n <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span></span></code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Yichao Hua.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

