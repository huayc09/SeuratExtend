<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Enhanced Violin Plot — VlnPlot2 • SeuratExtend</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Enhanced Violin Plot — VlnPlot2"><meta property="og:description" content="Generates advanced violin plots distinct from Seurat's VlnPlot. This improved version offers a more compact design for efficient space utilization, the ability to overlay a boxplot, and convenient inclusion of statistical annotations. The function accommodates input in the form of either a Seurat object or a data frame."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">SeuratExtend</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.2.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Vignettes
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/News.html">What's New in v1.1.0</a>
    </li>
    <li class="divider">
    <li>
      <a href="../articles/Visualization.html">Enhanced Visualization</a>
    </li>
    <li>
      <a href="../articles/GSEA.html">Geneset Enrichment Analysis (GSEA) </a>
    </li>
    <li>
      <a href="../articles/Trajectory.html">Trajectory and Pseudotime Analysis </a>
    </li>
    <li>
      <a href="../articles/SCENIC.html">SCENIC for Gene Regulatory Networks Analysis </a>
    </li>
    <li>
      <a href="../articles/Utilities.html">Utility Tools and Functions</a>
    </li>
  </ul></li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    scRNA-seq Course
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/single-cell-course/1.basic-R.html">1. Introduction to R</a>
    </li>
    <li>
      <a href="../articles/single-cell-course/2.Seurat.html">2. Basic Single-Cell Analysis Workflow</a>
    </li>
    <li>
      <a href="../articles/single-cell-course/3.Visualization.html">3. Advanced Visualization Techniques</a>
    </li>
    <li>
      <a href="../articles/single-cell-course/4.GSEA.html">4. Gene Set Enrichment Analysis</a>
    </li>
    <li>
      <a href="../articles/single-cell-course/5.Core-Enhancement.html">5. Core scRNA-seq Workflow Enhancements</a>
    </li>
    <li>
      <a href="../articles/single-cell-course/6.Advanced.html">6. Advanced Methods (Part 1)</a>
    </li>
    <li>
      <a href="../articles/single-cell-course/6.Advanced-2.html">7. Advanced Methods (Part 2)</a>
    </li>
  </ul></li>
<li>
  <a href="../articles/FAQ.html">FAQ</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"></ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Enhanced Violin Plot</h1>
    
    <div class="hidden name"><code>VlnPlot2.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Generates advanced violin plots distinct from Seurat's VlnPlot. This improved version offers a more compact design for efficient space utilization, the ability to overlay a boxplot, and convenient inclusion of statistical annotations. The function accommodates input in the form of either a Seurat object or a data frame.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">VlnPlot2</span><span class="op">(</span><span class="va">object</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for Seurat</span></span>
<span><span class="fu">VlnPlot2</span><span class="op">(</span></span>
<span>  <span class="va">seu</span>,</span>
<span>  <span class="va">features</span>,</span>
<span>  group.by <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  split.by <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  cells <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  slot <span class="op">=</span> <span class="st">"data"</span>,</span>
<span>  assay <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  priority <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"expr"</span>, <span class="st">"none"</span><span class="op">)</span>,</span>
<span>  cols <span class="op">=</span> <span class="st">"light"</span>,</span>
<span>  load.cols <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  ncol <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  nrow <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  lab_fill <span class="op">=</span> <span class="st">"group"</span>,</span>
<span>  scales <span class="op">=</span> <span class="st">"free_y"</span>,</span>
<span>  style <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"fill"</span>, <span class="st">"outline"</span><span class="op">)</span>,</span>
<span>  violin <span class="op">=</span> <span class="cn">T</span>,</span>
<span>  box <span class="op">=</span> <span class="cn">T</span>,</span>
<span>  width <span class="op">=</span> <span class="fl">0.9</span>,</span>
<span>  show.mean <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  mean_colors <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"red"</span>, <span class="st">"blue"</span><span class="op">)</span>,</span>
<span>  pt <span class="op">=</span> <span class="cn">T</span>,</span>
<span>  hide.outlier <span class="op">=</span> <span class="cn">F</span>,</span>
<span>  pt.style <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"jitter"</span>, <span class="st">"quasirandom"</span><span class="op">)</span>,</span>
<span>  pt.size <span class="op">=</span> <span class="fl">0.2</span>,</span>
<span>  pt.alpha <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  strip.position <span class="op">=</span> <span class="st">"top"</span>,</span>
<span>  stat.method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"none"</span>, <span class="st">"wilcox.test"</span>, <span class="st">"t.test"</span><span class="op">)</span>,</span>
<span>  stats.method <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  p.adjust.method <span class="op">=</span> <span class="st">"holm"</span>,</span>
<span>  label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"p.signif"</span>, <span class="st">"p"</span>, <span class="st">"p.adj"</span>, <span class="st">"p.format"</span><span class="op">)</span>,</span>
<span>  comparisons <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  hide.ns <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  step.increase <span class="op">=</span> <span class="fl">0.12</span>,</span>
<span>  tip.length <span class="op">=</span> <span class="fl">0.03</span>,</span>
<span>  angle <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  hjust <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  vjust <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for default</span></span>
<span><span class="fu">VlnPlot2</span><span class="op">(</span></span>
<span>  <span class="va">matr</span>,</span>
<span>  <span class="va">f</span>,</span>
<span>  f2 <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  features <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  t <span class="op">=</span> <span class="cn">F</span>,</span>
<span>  cols <span class="op">=</span> <span class="st">"light"</span>,</span>
<span>  ncol <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  nrow <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  lab_fill <span class="op">=</span> <span class="st">"group"</span>,</span>
<span>  scales <span class="op">=</span> <span class="st">"free_y"</span>,</span>
<span>  style <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"fill"</span>, <span class="st">"outline"</span><span class="op">)</span>,</span>
<span>  violin <span class="op">=</span> <span class="cn">T</span>,</span>
<span>  box <span class="op">=</span> <span class="cn">T</span>,</span>
<span>  width <span class="op">=</span> <span class="fl">0.9</span>,</span>
<span>  show.mean <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  mean_colors <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"red"</span>, <span class="st">"blue"</span><span class="op">)</span>,</span>
<span>  pt <span class="op">=</span> <span class="cn">T</span>,</span>
<span>  hide.outlier <span class="op">=</span> <span class="cn">F</span>,</span>
<span>  pt.style <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"jitter"</span>, <span class="st">"quasirandom"</span><span class="op">)</span>,</span>
<span>  pt.size <span class="op">=</span> <span class="fl">0.2</span>,</span>
<span>  pt.alpha <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  strip.position <span class="op">=</span> <span class="st">"top"</span>,</span>
<span>  stat.method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"none"</span>, <span class="st">"wilcox.test"</span>, <span class="st">"t.test"</span><span class="op">)</span>,</span>
<span>  stats.method <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  p.adjust.method <span class="op">=</span> <span class="st">"holm"</span>,</span>
<span>  label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"p.signif"</span>, <span class="st">"p"</span>, <span class="st">"p.adj"</span>, <span class="st">"p.format"</span><span class="op">)</span>,</span>
<span>  comparisons <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  hide.ns <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  step.increase <span class="op">=</span> <span class="fl">0.12</span>,</span>
<span>  tip.length <span class="op">=</span> <span class="fl">0.03</span>,</span>
<span>  angle <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  hjust <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  vjust <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>object</dt>
<dd><p>An object, either a Seurat object or matrix.</p></dd>


<dt>...</dt>
<dd><p>Further arguments passed to the <code><a href="https://rpkgs.datanovia.com/ggpubr/reference/stat_pvalue_manual.html" class="external-link">ggpubr::stat_pvalue_manual()</a></code>.</p></dd>


<dt>seu</dt>
<dd><p>A Seurat object. Only applicable for the Seurat method.</p></dd>


<dt>features</dt>
<dd><p>Features to depict, such as gene expression, metrics, PC scores, or any data obtainable via `FetchData()`. Default: NULL (all features in matrix).</p></dd>


<dt>group.by</dt>
<dd><p>A variable from `meta.data` for grouping or a character vector of equal length as the number of cells. Only applicable for the Seurat method.</p></dd>


<dt>split.by</dt>
<dd><p>A variable from `meta.data` to bifurcate the violin plots. Only applicable for the Seurat method.</p></dd>


<dt>cells</dt>
<dd><p>Cell identifiers for use. Defaults to all cells. Only applicable for the Seurat method.</p></dd>


<dt>slot</dt>
<dd><p>Slot to retrieve feature data from. Only applicable for the Seurat method.</p></dd>


<dt>assay</dt>
<dd><p>Name of the assay to employ. Defaults to the active assay. Only applicable for the Seurat method.</p></dd>


<dt>priority</dt>
<dd><p>If set to "expr", extracts data from the expression matrix over `meta.data`. Only applicable for the Seurat method.</p></dd>


<dt>cols</dt>
<dd><p>Flexible color settings for the plot, accepting a variety of inputs:</p>
<p>- Eight color_pro styles: "default", "light", "pro_red", "pro_yellow", "pro_green", "pro_blue", "pro_purple", "bright".</p>
<p>- Five color_iwh styles: "iwh_default", "iwh_intense", "iwh_pastel", "iwh_all", "iwh_all_hard".</p>
<p>- Brewer color scales as specified by `brewer.pal.info`.</p>
<p>- Any manually specified colors.</p></dd>


<dt>load.cols</dt>
<dd><p>When TRUE, automatically loads pre-stored color information for variables from `seu@misc[["var_colors"]]`.</p></dd>


<dt>ncol</dt>
<dd><p>Specifies the number of columns for display if multiple plots are shown. Default: NULL.</p></dd>


<dt>nrow</dt>
<dd><p>Specifies the number of rows for display if multiple plots are shown. Default: NULL.</p></dd>


<dt>lab_fill</dt>
<dd><p>Label for the figure legend. Default: 'group'.</p></dd>


<dt>scales</dt>
<dd><p>Scales parameter passed to <code><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">ggplot2::facet_wrap()</a></code>. Default: 'free_y'.</p></dd>


<dt>style</dt>
<dd><p>Plot style: "fill" (default) uses filled violins with group colors, "outline" uses white fill with colored outlines.</p></dd>


<dt>violin</dt>
<dd><p>Indicates whether to generate a violin plot. Default: TRUE.</p></dd>


<dt>box</dt>
<dd><p>Indicates whether to depict a box plot. Default: TRUE.</p></dd>


<dt>width</dt>
<dd><p>Width of the box plot. Default: 0.9.</p></dd>


<dt>show.mean</dt>
<dd><p>Logical value indicating whether to show mean and median lines. This is particularly useful for genes with low expression levels where the median and box plot quartiles might overlap at zero, making it difficult to interpret differences between groups. Default is FALSE.</p></dd>


<dt>mean_colors</dt>
<dd><p>Vector of two colors for mean and median lines respectively. Default is c("red", "blue").</p></dd>


<dt>pt</dt>
<dd><p>Indicates if points should be plotted. Default: TRUE.</p></dd>


<dt>hide.outlier</dt>
<dd><p>Conceals outlier points from the box plot. Default: FALSE.</p></dd>


<dt>pt.style</dt>
<dd><p>Position adjustment. Default choices: "jitter", "quasirandom".</p></dd>


<dt>pt.size</dt>
<dd><p>Point size setting. Default: 0.2.</p></dd>


<dt>pt.alpha</dt>
<dd><p>Adjusts the transparency of points. Default: 1.</p></dd>


<dt>strip.position</dt>
<dd><p>Positions the strip ("top" (default), "bottom", "left", or "right"). Only used when `f2 = NULL`.</p></dd>


<dt>stat.method</dt>
<dd><p>Determines if pairwise statistics are added to the plot. Either "wilcox.test" or "t.test". Default: "none".</p></dd>


<dt>stats.method</dt>
<dd><p>Alias for <code>stat.method</code>. Provided for convenience but <code>stat.method</code> is preferred.
When both are provided, <code>stats.method</code> takes precedence.</p></dd>


<dt>p.adjust.method</dt>
<dd><p>Method for adjusting p-values, especially when conducting multiple pairwise tests or dealing with multiple grouping variables. Options include "holm", "hochberg", "hommel", "bonferroni", "BH", "BY", "fdr", and "none". Note: Adjustments are independently conducted for each variable in formulas containing multiple variables. Default: 'holm'.</p></dd>


<dt>label</dt>
<dd><p>Specifies label type. Options include "p.signif" (showing significance levels), "p.format" (formatted p value), or "p", "p.adj". Default: "p.signif".</p></dd>


<dt>comparisons</dt>
<dd><p>List of length-2 vectors, each containing either names of two x-axis values or two integers pointing to groups of interest for comparison. Default: all groups.</p></dd>


<dt>hide.ns</dt>
<dd><p>If TRUE, the 'ns' symbol is concealed when displaying significance levels. Default: TRUE.</p></dd>


<dt>step.increase</dt>
<dd><p>Numeric vector denoting the increase in fraction of total height for each additional comparison, minimizing overlap. Default: 0.12.</p></dd>


<dt>tip.length</dt>
<dd><p>Numeric vector indicating the fraction of total height the bar descends to specify the exact column. For a line display instead of a bracket, set to 0. Default: 0.03.</p></dd>


<dt>angle</dt>
<dd><p>Angle for label rotation. If NULL, automatically determined based on label length. Default: NULL.</p></dd>


<dt>hjust</dt>
<dd><p>Horizontal justification of labels. If NULL, automatically determined based on angle. Default: NULL.</p></dd>


<dt>vjust</dt>
<dd><p>Vertical justification of labels. If NULL, automatically determined based on angle. Default: NULL.</p></dd>


<dt>matr</dt>
<dd><p>A matrix or data frame with rows as features and columns as cells.</p></dd>


<dt>f</dt>
<dd><p>A factor or vector indicating the identity of each cell. Should match the column length of `matr`.</p></dd>


<dt>f2</dt>
<dd><p>A factor or vector akin to `f` for splitting the violin plots. Default: NULL.</p></dd>


<dt>t</dt>
<dd><p>If the matrix has features in columns and cells in rows, transpose the matrix first. Default: FALSE.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>ggplot object</p>


<p>A ggplot object.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>This function provides a range of customization options to generate violin plots, with or without additional graphical elements such as boxplots and points. You can specify features to plot, control the appearance of violin plots, boxplots, and points, adjust point position, group data, split violin plots, selectively use cells, control the column layout of multiple plots, and add statistical annotations. For a detailed overview, refer to the provided examples.</p>
<p>When using the statistical annotation feature (`stat.method`), it's important to be aware that p-values can be artificially inflated in large single-cell datasets due to the high number of cells. This may result in statistically significant differences (small p-values) even when the biological effect size is minimal. We recommend being cautious with statistical interpretations, especially when visual differences are subtle. Consider examining log fold changes (logFC) between groups to better assess the magnitude of biological differences. For a comprehensive visualization of differences between two groups, `WaterfallPlot()` can provide logFC values along with statistical significance. By default, the `VlnPlot2()` function uses the Holm method (`p.adjust.method = "holm"`) to adjust p-values for multiple comparisons, which helps control the family-wise error rate.</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://satijalab.org/seurat" class="external-link">Seurat</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">SeuratExtend</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Using Seurat object as input:</span></span>
<span></span>
<span><span class="co"># Basic violin plot with box plot and points:</span></span>
<span><span class="va">genes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"CD3D"</span>,<span class="st">"CD14"</span>,<span class="st">"CD79A"</span><span class="op">)</span></span>
<span><span class="fu">VlnPlot2</span><span class="op">(</span><span class="va">pbmc</span>, features <span class="op">=</span> <span class="va">genes</span>, ncol <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Without violin plot, only box plot, and use quasirandom style for point position adjustment:</span></span>
<span><span class="fu">VlnPlot2</span><span class="op">(</span><span class="va">pbmc</span>, features <span class="op">=</span> <span class="va">genes</span>, violin <span class="op">=</span> <span class="cn">F</span>, pt.style <span class="op">=</span> <span class="st">"quasirandom"</span>, ncol <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Hide points but display outlier points of the box plot:</span></span>
<span><span class="fu">VlnPlot2</span><span class="op">(</span><span class="va">pbmc</span>, features <span class="op">=</span> <span class="va">genes</span>, pt <span class="op">=</span> <span class="cn">FALSE</span>, ncol <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># When hiding points, outliers are shown by default (recommended). However, outliers can be hidden for a cleaner appearance:</span></span>
<span><span class="fu">VlnPlot2</span><span class="op">(</span><span class="va">pbmc</span>, features <span class="op">=</span> <span class="va">genes</span>, pt <span class="op">=</span> <span class="cn">FALSE</span>, hide.outlier <span class="op">=</span> <span class="cn">T</span>, ncol <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Using the outline style instead of filled violins:</span></span>
<span><span class="fu">VlnPlot2</span><span class="op">(</span><span class="va">pbmc</span>, features <span class="op">=</span> <span class="va">genes</span>, style <span class="op">=</span> <span class="st">"outline"</span>, ncol <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Group by cluster and split each cluster by samples:</span></span>
<span><span class="fu">VlnPlot2</span><span class="op">(</span><span class="va">pbmc</span>, features <span class="op">=</span> <span class="va">genes</span>, group.by <span class="op">=</span> <span class="st">"cluster"</span>, split.by <span class="op">=</span> <span class="st">"orig.ident"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># For genes with low expression where boxplot might be hard to interpret</span></span>
<span><span class="co"># (e.g., when median and quartiles overlap at zero),</span></span>
<span><span class="co"># you can add mean/median lines for better visualization:</span></span>
<span><span class="va">lowExprGenes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"CCR7"</span>, <span class="st">"IL7R"</span>, <span class="st">"TCF7"</span><span class="op">)</span></span>
<span><span class="fu">VlnPlot2</span><span class="op">(</span><span class="va">pbmc</span>, features <span class="op">=</span> <span class="va">lowExprGenes</span>, show.mean <span class="op">=</span> <span class="cn">TRUE</span>, cols <span class="op">=</span> <span class="st">"light"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Display only cells from certain subtypes (e.g. B cell, CD14+ Mono, and CD8 T cell), and arrange plots in 3 columns:</span></span>
<span><span class="va">cells</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">pbmc</span><span class="op">)</span><span class="op">[</span><span class="va">pbmc</span><span class="op">$</span><span class="va">cluster</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"B cell"</span>, <span class="st">"Mono CD14"</span>, <span class="st">"CD8 T cell"</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="fu">VlnPlot2</span><span class="op">(</span><span class="va">pbmc</span>, features <span class="op">=</span> <span class="va">genes</span>, group.by <span class="op">=</span> <span class="st">"cluster"</span>, cells <span class="op">=</span> <span class="va">cells</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Add statistical annotations using the Wilcoxon test for pairwise comparisons and hide non-significant results:</span></span>
<span><span class="fu">VlnPlot2</span><span class="op">(</span><span class="va">pbmc</span>, features <span class="op">=</span> <span class="va">genes</span>, group.by <span class="op">=</span> <span class="st">"cluster"</span>, cell <span class="op">=</span> <span class="va">cells</span>,</span>
<span>         stat.method <span class="op">=</span> <span class="st">"wilcox.test"</span>, hide.ns <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Display statistics comparing only the specified clusters using a t-test:</span></span>
<span><span class="fu">VlnPlot2</span><span class="op">(</span><span class="va">pbmc</span>, features <span class="op">=</span> <span class="va">genes</span>, group.by <span class="op">=</span> <span class="st">"cluster"</span>, cell <span class="op">=</span> <span class="va">cells</span>,</span>
<span>         stat.method <span class="op">=</span> <span class="st">"t.test"</span>, comparisons <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">3</span><span class="op">)</span><span class="op">)</span>, hide.ns <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Using a matrix as input:</span></span>
<span><span class="co"># For instance, after performing Geneset Enrichment Analysis (GSEA) using the Hallmark 50 geneset to obtain the AUCell matrix:</span></span>
<span><span class="va">pbmc</span> <span class="op">&lt;-</span> <span class="fu"><a href="GeneSetAnalysis.html">GeneSetAnalysis</a></span><span class="op">(</span><span class="va">pbmc</span>, genesets <span class="op">=</span> <span class="va">hall50</span><span class="op">$</span><span class="va">human</span><span class="op">)</span></span>
<span><span class="va">matr</span> <span class="op">&lt;-</span> <span class="va">pbmc</span><span class="op">@</span><span class="va">misc</span><span class="op">$</span><span class="va">AUCell</span><span class="op">$</span><span class="va">genesets</span></span>
<span></span>
<span><span class="co"># Create violin plots for the first three pathways:</span></span>
<span><span class="fu">VlnPlot2</span><span class="op">(</span><span class="va">matr</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>,<span class="op">]</span>, f <span class="op">=</span> <span class="va">pbmc</span><span class="op">$</span><span class="va">cluster</span>, ncol <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Yichao Hua.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

