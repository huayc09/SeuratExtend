<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Enhanced Dot Plot for Single-Cell Data Visualization — DotPlot2 • SeuratExtend</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Enhanced Dot Plot for Single-Cell Data Visualization — DotPlot2"><meta property="og:description" content="Creates an enhanced dot plot for visualizing gene expression across different cell types or clusters in single-cell data, with support for split visualization."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">SeuratExtend</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.2.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Vignettes
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/News.html">What's New in v1.1.0</a>
    </li>
    <li class="divider">
    <li>
      <a href="../articles/Visualization.html">Enhanced Visualization</a>
    </li>
    <li>
      <a href="../articles/GSEA.html">Geneset Enrichment Analysis (GSEA) </a>
    </li>
    <li>
      <a href="../articles/Trajectory.html">Trajectory and Pseudotime Analysis </a>
    </li>
    <li>
      <a href="../articles/SCENIC.html">SCENIC for Gene Regulatory Networks Analysis </a>
    </li>
    <li>
      <a href="../articles/Utilities.html">Utility Tools and Functions</a>
    </li>
  </ul></li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    scRNA-seq Course
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/single-cell-course/1.basic-R.html">1. Introduction to R</a>
    </li>
    <li>
      <a href="../articles/single-cell-course/2.Seurat.html">2. Basic Single-Cell Analysis Workflow</a>
    </li>
    <li>
      <a href="../articles/single-cell-course/3.Visualization.html">3. Advanced Visualization Techniques</a>
    </li>
    <li>
      <a href="../articles/single-cell-course/4.GSEA.html">4. Gene Set Enrichment Analysis</a>
    </li>
    <li>
      <a href="../articles/single-cell-course/5.Core-Enhancement.html">5. Core scRNA-seq Workflow Enhancements</a>
    </li>
    <li>
      <a href="../articles/single-cell-course/6.Advanced.html">6. Advanced Methods (Part 1)</a>
    </li>
    <li>
      <a href="../articles/single-cell-course/6.Advanced-2.html">7. Advanced Methods (Part 2)</a>
    </li>
  </ul></li>
<li>
  <a href="../articles/FAQ.html">FAQ</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"></ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Enhanced Dot Plot for Single-Cell Data Visualization</h1>
    
    <div class="hidden name"><code>DotPlot2.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Creates an enhanced dot plot for visualizing gene expression across different cell types or clusters in single-cell data, with support for split visualization.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">DotPlot2</span><span class="op">(</span></span>
<span>  <span class="va">seu</span>,</span>
<span>  <span class="va">features</span>,</span>
<span>  group.by <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  split.by <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  split.by.method <span class="op">=</span> <span class="st">"border"</span>,</span>
<span>  nudge_factor <span class="op">=</span> <span class="fl">0.35</span>,</span>
<span>  color_scheme <span class="op">=</span> <span class="st">"A"</span>,</span>
<span>  split.by.colors <span class="op">=</span> <span class="st">"bright"</span>,</span>
<span>  center_color <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  angle <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  hjust <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  vjust <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  legend_position <span class="op">=</span> <span class="st">"right"</span>,</span>
<span>  plot.margin <span class="op">=</span> <span class="fu">margin</span><span class="op">(</span>t <span class="op">=</span> <span class="fl">5.5</span>, r <span class="op">=</span> <span class="fl">5.5</span>, b <span class="op">=</span> <span class="fl">5.5</span>, l <span class="op">=</span> <span class="fl">5.5</span><span class="op">)</span>,</span>
<span>  panel.spacing <span class="op">=</span> <span class="fu">unit</span><span class="op">(</span><span class="fl">5</span>, <span class="st">"pt"</span><span class="op">)</span>,</span>
<span>  strip.placement <span class="op">=</span> <span class="st">"outside"</span>,</span>
<span>  border <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  border.width <span class="op">=</span> <span class="fl">0.6</span>,</span>
<span>  flip <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  free_space <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  show_grid <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>seu</dt>
<dd><p>A Seurat object.</p></dd>


<dt>features</dt>
<dd><p>A vector of gene names or a list of named vectors for grouped features.</p></dd>


<dt>group.by</dt>
<dd><p>Column name in seu@meta.data for grouping cells. Default: NULL (uses current Idents).</p></dd>


<dt>split.by</dt>
<dd><p>Column name in seu@meta.data for splitting the groups. Default: NULL.</p></dd>


<dt>split.by.method</dt>
<dd><p>Method for visualizing the split groups. Options are "border" or "color". Default: "border".
  - "border": Uses different border colors to represent different split groups, while the fill color represents the expression level.</p>
<p>- "color": Uses different dot colors to represent different split groups, while the transparency represents the expression level.</p></dd>


<dt>nudge_factor</dt>
<dd><p>Factor to adjust the spacing between split groups. Default: 0.35.</p></dd>


<dt>color_scheme</dt>
<dd><p>Color scheme for the plot. When split.by is NULL, or when split.by is specified and split.by.method is "border", this color scheme is used to represent the relative expression level (zscore). Default: 'A'.
   This parameter accepts multiple input formats to provide flexibility in defining color schemes:</p>
<p>- Predefined color schemes from the `viridis` package ("A" to "H").</p>
<p>- Named vector with keys "low", "mid", and "high" for three-point gradients. Example: `c(low = muted("blue"), mid = "white", high = muted("red"))`.</p>
<p>- Two-point gradient with keys "low" and "high". Example: `c(low = "lightblue", high = "red")`.</p>
<p>- RColorBrewer sequential palettes: "Blues", "BuGn", "BuPu", "GnBu", "Greens", "Greys", "Oranges", "OrRd", "PuBu", "PuBuGn", "PuRd", "Purples", "RdPu", "Reds", "YlGn", "YlGnBu", "YlOrBr", "YlOrRd".</p>
<p>- RColorBrewer diverging palettes: "BrBG", "PiYG", "PRGn", "PuOr", "RdBu", "RdGy", "RdYlBu", "RdYlGn", "Spectral".</p>
<p>- Custom diverging palettes: "GnYlRd", "BuYlRd", "GyRd", "BuRd", "PuOr".</p>
<p>- Append "-rev" to any RColorBrewer palette name to reverse the color order. Example: "RdBu-rev".</p>
<p>- Custom color gradient using a vector of colors.</p></dd>


<dt>split.by.colors</dt>
<dd><p>Colors for split groups. When split.by.method is "border", this sets the border colors; when split.by.method is "color", this sets the dot colors.
Flexible color settings for the plot, accepting a variety of inputs:</p>
<p>- Eight color_pro styles: "default", "light", "pro_red", "pro_yellow", "pro_green", "pro_blue", "pro_purple", "bright" (default).</p>
<p>- Five color_iwh styles: "iwh_default", "iwh_intense", "iwh_pastel", "iwh_all", "iwh_all_hard".</p>
<p>- Brewer color scales as specified by `brewer.pal.info`.</p>
<p>- Any manually specified colors.</p></dd>


<dt>center_color</dt>
<dd><p>Center color for diverging color schemes. Default: NULL.</p></dd>


<dt>angle</dt>
<dd><p>Angle of x-axis labels. Default: NULL (auto-determined).</p></dd>


<dt>hjust</dt>
<dd><p>Horizontal justification of x-axis labels. Default: NULL (auto-determined).</p></dd>


<dt>vjust</dt>
<dd><p>Vertical justification of x-axis labels. Default: NULL (auto-determined).</p></dd>


<dt>legend_position</dt>
<dd><p>Position of the legend. Default: 'right'.</p></dd>


<dt>plot.margin</dt>
<dd><p>Margins around the plot. Default: margin(t = 5.5, r = 5.5, b = 5.5, l = 5.5).</p></dd>


<dt>panel.spacing</dt>
<dd><p>Spacing between facet panels. Default: unit(5, "pt").</p></dd>


<dt>strip.placement</dt>
<dd><p>Placement of facet labels. Default: 'outside'.</p></dd>


<dt>border</dt>
<dd><p>Whether to draw borders around points when split.by is NULL. Default: TRUE.</p></dd>


<dt>border.width</dt>
<dd><p>Width of the border around points. Default: 0.6.</p></dd>


<dt>flip</dt>
<dd><p>Whether to flip the coordinates of the plot. Default: FALSE.</p></dd>


<dt>free_space</dt>
<dd><p>Whether to allow free space in facets. Default: TRUE.</p></dd>


<dt>show_grid</dt>
<dd><p>Whether to show grid lines. Default: TRUE.</p></dd>


<dt>...</dt>
<dd><p>Additional arguments passed to theme().</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>A ggplot object representing the dot plot.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>This function creates a dot plot where the size of each dot represents the percentage of cells
expressing the gene, and the color represents the average expression level (corrected expression level, zscore). It supports
grouped features, coordinate flipping, and various customization options. The function also
allows for splitting the visualization by a specified variable, offering two methods of
representation:
1. Using border colors (split.by.method = "border"): In this method, the fill color of the dots represents
   the expression level, while the border color represents the split group. This allows for easy
   comparison of expression levels across different split groups.
2. Using dot colors (split.by.method = "color"): In this method, the color of the dots represents
   the split group, while the transparency represents the expression level. This can be useful when
   the focus is on comparing the distribution of split groups across different cell types or genes.</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="co"># Basic usage</span></span>
<span><span class="va">genes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://satijalab.github.io/seurat-object/reference/VariableFeatures.html" class="external-link">VariableFeatures</a></span><span class="op">(</span><span class="va">pbmc</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span></span>
<span><span class="fu">DotPlot2</span><span class="op">(</span><span class="va">pbmc</span>, features <span class="op">=</span> <span class="va">genes</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Grouped features</span></span>
<span><span class="fu">DotPlot2</span><span class="op">(</span><span class="va">pbmc</span>, features <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>group1 <span class="op">=</span> <span class="va">genes</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span>, group2 <span class="op">=</span> <span class="va">genes</span><span class="op">[</span><span class="fl">4</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Split visualization by sample</span></span>
<span><span class="fu">DotPlot2</span><span class="op">(</span><span class="va">pbmc</span>, features <span class="op">=</span> <span class="va">genes</span>, group.by <span class="op">=</span> <span class="st">"cluster"</span>, split.by <span class="op">=</span> <span class="st">"orig.ident"</span>, show_grid <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Split visualization using colors instead of borders</span></span>
<span><span class="fu">DotPlot2</span><span class="op">(</span><span class="va">pbmc</span>, features <span class="op">=</span> <span class="va">genes</span>, group.by <span class="op">=</span> <span class="st">"cluster"</span>, split.by <span class="op">=</span> <span class="st">"orig.ident"</span>, split.by.method <span class="op">=</span> <span class="st">"color"</span>, show_grid <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Custom settings</span></span>
<span><span class="fu">DotPlot2</span><span class="op">(</span><span class="va">pbmc</span>, features <span class="op">=</span> <span class="va">genes</span>, color_scheme <span class="op">=</span> <span class="st">"OrRd"</span>, show_grid <span class="op">=</span> <span class="cn">FALSE</span>, border <span class="op">=</span> <span class="cn">FALSE</span>, flip <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Yichao Hua.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

