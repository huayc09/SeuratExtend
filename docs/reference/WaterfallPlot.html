<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Waterfall Plot — WaterfallPlot • SeuratExtend</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Waterfall Plot — WaterfallPlot"><meta property="og:description" content="Generates a waterfall plot."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">SeuratExtend</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Vignettes
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/News.html">What's New in v1.1.0</a>
    </li>
    <li class="divider">
    <li>
      <a href="../articles/Visualization.html">Enhanced Visualization</a>
    </li>
    <li>
      <a href="../articles/GSEA.html">Geneset Enrichment Analysis (GSEA) </a>
    </li>
    <li>
      <a href="../articles/Trajectory.html">Trajectory and Pseudotime Analysis </a>
    </li>
    <li>
      <a href="../articles/SCENIC.html">SCENIC for Gene Regulatory Networks Analysis </a>
    </li>
    <li>
      <a href="../articles/Utilities.html">Utility Tools and Functions</a>
    </li>
  </ul></li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    scRNA-seq Course
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/single-cell-course/1.basic-R.html">1. Introduction to R</a>
    </li>
    <li>
      <a href="../articles/single-cell-course/2.Seurat.html">2. Basic Single-Cell Analysis Workflow</a>
    </li>
    <li>
      <a href="../articles/single-cell-course/3.Visualization.html">3. Advanced Visualization Techniques</a>
    </li>
    <li>
      <a href="../articles/single-cell-course/4.GSEA.html">4. Gene Set Enrichment Analysis</a>
    </li>
    <li>
      <a href="../articles/single-cell-course/5.Core-Enhancement.html">5. Core scRNA-seq Workflow Enhancements</a>
    </li>
    <li>
      <a href="../articles/single-cell-course/6.Advanced.html">6. Advanced Methods (Part 1)</a>
    </li>
    <li>
      <a href="../articles/single-cell-course/6.Advanced-2.html">7. Advanced Methods (Part 2)</a>
    </li>
  </ul></li>
<li>
  <a href="../articles/FAQ.html">FAQ</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"></ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Waterfall Plot</h1>
    
    <div class="hidden name"><code>WaterfallPlot.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Generates a waterfall plot.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">WaterfallPlot</span><span class="op">(</span><span class="va">object</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for Seurat</span></span>
<span><span class="fu">WaterfallPlot</span><span class="op">(</span></span>
<span>  <span class="va">seu</span>,</span>
<span>  <span class="va">features</span>,</span>
<span>  group.by <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  cell <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  cells <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  slot <span class="op">=</span> <span class="st">"data"</span>,</span>
<span>  assay <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  priority <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"expr"</span>, <span class="st">"none"</span><span class="op">)</span>,</span>
<span>  ident.1 <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  ident.2 <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  exp.transform <span class="op">=</span> <span class="op">(</span><span class="va">length</span> <span class="op">==</span> <span class="st">"logFC"</span><span class="op">)</span>,</span>
<span>  order <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  length <span class="op">=</span> <span class="st">"logFC"</span>,</span>
<span>  color <span class="op">=</span> <span class="st">"p"</span>,</span>
<span>  len.threshold <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  col.threshold <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  color_theme <span class="op">=</span> <span class="st">"BuRd"</span>,</span>
<span>  center_color <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  top.n <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  flip <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  y.label <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  angle <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  hjust <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  vjust <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  title <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  style <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"bar"</span>, <span class="st">"segment"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for default</span></span>
<span><span class="fu">WaterfallPlot</span><span class="op">(</span></span>
<span>  <span class="va">matr</span>,</span>
<span>  <span class="va">f</span>,</span>
<span>  ident.1 <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  ident.2 <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  exp.transform <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  order <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  length <span class="op">=</span> <span class="st">"tscore"</span>,</span>
<span>  color <span class="op">=</span> <span class="st">"tscore"</span>,</span>
<span>  len.threshold <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  col.threshold <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  color_theme <span class="op">=</span> <span class="st">"BuRd"</span>,</span>
<span>  center_color <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  top.n <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  flip <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  y.label <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  angle <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  hjust <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  vjust <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  title <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  style <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"bar"</span>, <span class="st">"segment"</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>object</dt>
<dd><p>Either a Seurat object or a matrix.</p></dd>


<dt>...</dt>
<dd><p>Additional arguments passed to other methods.</p></dd>


<dt>seu</dt>
<dd><p>A Seurat object. Only applicable when using the Seurat method.</p></dd>


<dt>features</dt>
<dd><p>Features to be plotted, which can include gene expression, metrics, PC scores, or any other data that can be retrieved using the `FetchData()` function. Only applicable for the Seurat method.</p></dd>


<dt>group.by</dt>
<dd><p>A variable from `meta.data` for grouping, or a character vector of the same length as the number of cells. Only applicable for the Seurat method.</p></dd>


<dt>cell</dt>
<dd><p>Cell identifiers to be used in the plot. Defaults to all cells. Only applicable for the Seurat method.</p></dd>


<dt>cells</dt>
<dd><p>Alternative parameter name for cell identifiers. Same functionality as 'cell'. Defaults to all cells.</p></dd>


<dt>slot</dt>
<dd><p>Slot from which to retrieve feature data. Only applicable for the Seurat method.</p></dd>


<dt>assay</dt>
<dd><p>Name of the assay to use. If not specified, the active assay will be used. Only applicable for the Seurat method.</p></dd>


<dt>priority</dt>
<dd><p>If set to "expr", the function will fetch data from the expression matrix rather than `meta.data`. Only applicable for the Seurat method.</p></dd>


<dt>ident.1</dt>
<dd><p>The primary identity class. If not specified, the first class will be used.</p></dd>


<dt>ident.2</dt>
<dd><p>An optional secondary identity class for comparison. If NULL, comparisons will be made against all other cells.</p></dd>


<dt>exp.transform</dt>
<dd><p>Indicates whether to transform data using `expm1`. This is particularly useful when calculating the log fold change of normalized gene counts. Defaults to FALSE for matrix input and TRUE for Seurat object input.</p></dd>


<dt>order</dt>
<dd><p>Determines whether the features should be ordered. Defaults to TRUE.</p></dd>


<dt>length</dt>
<dd><p>Specifies the statistic to determine the length of the bar. Possible values are "tscore" (default for matrix input), "p", or "logFC" (default for Seurat object input).</p></dd>


<dt>color</dt>
<dd><p>Specifies the statistic to determine the color of the bar. Possible values are "tscore" (default), "p" (default for Seurat object input), or "logFC".</p></dd>


<dt>len.threshold</dt>
<dd><p>Excludes features with a value for the `length` parameter below this threshold. Defaults to 0.</p></dd>


<dt>col.threshold</dt>
<dd><p>Excludes features with a value for the `color` parameter below this threshold. Defaults to 0.</p></dd>


<dt>center_color</dt>
<dd><p>Logical or NULL. Determines whether the color scale should be centered at zero.
If TRUE, the color scale will be centered at zero, with the midpoint color representing zero.
If FALSE, the color scale will span the full range of the data without centering.
If NULL (default), it will automatically determine based on the color scheme:
TRUE for diverging color palettes, FALSE for sequential palettes or custom color schemes.
This is particularly useful for visualizing data with both positive and negative values,
such as z-scores or log fold changes.</p></dd>


<dt>top.n</dt>
<dd><p>Retains only the top `n` bars in both positive and negative directions. If `length(top.n)` is 1, the function retains `top.n` bars for both positive and negative directions. If `length(top.n)` is 2, it retains `top.n[1]` positive bars and `top.n[2]` negative bars. Defaults to NULL.</p></dd>


<dt>flip</dt>
<dd><p>Determines whether the plot should be flipped. Defaults to TRUE for matrix input and FALSE for Seurat object input.</p></dd>


<dt>y.label</dt>
<dd><p>Label for the y-axis. Defaults to "length".</p></dd>


<dt>angle</dt>
<dd><p>Angle of the x-axis labels. This argument is passed to `element_text()`.</p></dd>


<dt>hjust</dt>
<dd><p>Horizontal justification for the x-axis labels. This argument is passed to `element_text()`.</p></dd>


<dt>vjust</dt>
<dd><p>Vertical justification for the x-axis labels. This argument is passed to `element_text()`.</p></dd>


<dt>title</dt>
<dd><p>Title of the plot. Defaults to NULL.</p></dd>


<dt>style</dt>
<dd><p>Character string specifying the plot style. Either "bar" (default) for traditional bar plot style, or
"segment" for thin segments with end points.</p></dd>


<dt>matr</dt>
<dd><p>A matrix or data frame where rows represent features and columns represent cells.</p></dd>


<dt>f</dt>
<dd><p>A factor or vector indicating the identity of each cell. The length should match the number of columns in `matr`.</p></dd>


<dt>color_scheme</dt>
<dd><p>Specifies the color gradient for the heatmap visualization.
  This parameter accepts multiple input formats to provide flexibility in defining color schemes:</p>
<p>- Predefined color schemes from the `viridis` package ("A" to "H").</p>
<p>- Named vector with keys "low", "mid", and "high" for three-point gradients. Example: `c(low = muted("blue"), mid = "white", high = muted("red"))`.</p>
<p>- Two-point gradient with keys "low" and "high". Example: `c(low = "lightblue", high = "red")`.</p>
<p>- RColorBrewer sequential palettes: "Blues", "BuGn", "BuPu", "GnBu", "Greens", "Greys", "Oranges", "OrRd", "PuBu", "PuBuGn", "PuRd", "Purples", "RdPu", "Reds", "YlGn", "YlGnBu", "YlOrBr", "YlOrRd".</p>
<p>- RColorBrewer diverging palettes: "BrBG", "PiYG", "PRGn", "PuOr", "RdBu", "RdGy", "RdYlBu", "RdYlGn", "Spectral".</p>
<p>- Custom diverging palettes: "GnYlRd", "BuYlRd", "GyRd", "BuRd", "PuOr".</p>
<p>- Append "-rev" to any RColorBrewer palette name to reverse the color order. Example: "RdBu-rev".</p>
<p>- Custom color gradient using a vector of colors.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>A ggplot object.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>For more detailed usage, see the examples provided.</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="co"># First, create a matrix using the GeneSetAnalysis() function.</span></span>
<span><span class="co"># Rows represent the Hallmark 50 genesets, and columns represent cells.</span></span>
<span><span class="va">pbmc</span> <span class="op">&lt;-</span> <span class="fu"><a href="GeneSetAnalysis.html">GeneSetAnalysis</a></span><span class="op">(</span><span class="va">pbmc</span>, genesets <span class="op">=</span> <span class="va">hall50</span><span class="op">$</span><span class="va">human</span><span class="op">)</span></span>
<span><span class="va">matr</span> <span class="op">&lt;-</span> <span class="va">pbmc</span><span class="op">@</span><span class="va">misc</span><span class="op">$</span><span class="va">AUCell</span><span class="op">$</span><span class="va">genesets</span></span>
<span></span>
<span><span class="co"># Generate a waterfall plot comparing CD14+ Mono with CD8 T cells.</span></span>
<span><span class="fu">WaterfallPlot</span><span class="op">(</span><span class="va">matr</span>, f <span class="op">=</span> <span class="va">pbmc</span><span class="op">$</span><span class="va">cluster</span>, ident.1 <span class="op">=</span> <span class="st">"Mono CD14"</span>, ident.2 <span class="op">=</span> <span class="st">"CD8 T cell"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Keep only bars with a length (tscore, in this instance) greater than 1.</span></span>
<span><span class="fu">WaterfallPlot</span><span class="op">(</span><span class="va">matr</span>, f <span class="op">=</span> <span class="va">pbmc</span><span class="op">$</span><span class="va">cluster</span>, ident.1 <span class="op">=</span> <span class="st">"Mono CD14"</span>, ident.2 <span class="op">=</span> <span class="st">"CD8 T cell"</span>, len.threshold <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create a plot using the alternative segment style with points</span></span>
<span><span class="fu">WaterfallPlot</span><span class="op">(</span></span>
<span>  <span class="va">matr</span>,</span>
<span>  f <span class="op">=</span> <span class="va">pbmc</span><span class="op">$</span><span class="va">cluster</span>,</span>
<span>  ident.1 <span class="op">=</span> <span class="st">"Mono CD14"</span>,</span>
<span>  ident.2 <span class="op">=</span> <span class="st">"CD8 T cell"</span>,</span>
<span>  style <span class="op">=</span> <span class="st">"segment"</span>,</span>
<span>  color_theme <span class="op">=</span> <span class="st">"D"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Use a Seurat object as input and compare 100 genes, using LogFC as bar length.</span></span>
<span><span class="va">genes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://mojaveazure.github.io/seurat-object/reference/VariableFeatures.html" class="external-link">VariableFeatures</a></span><span class="op">(</span><span class="va">pbmc</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">80</span><span class="op">]</span></span>
<span><span class="fu">WaterfallPlot</span><span class="op">(</span></span>
<span>  <span class="va">pbmc</span>, group.by <span class="op">=</span> <span class="st">"cluster"</span>, features <span class="op">=</span> <span class="va">genes</span>,</span>
<span>  ident.1 <span class="op">=</span> <span class="st">"Mono CD14"</span>, ident.2 <span class="op">=</span> <span class="st">"CD8 T cell"</span>, length <span class="op">=</span> <span class="st">"logFC"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Keep only the top and bottom 20 genes.</span></span>
<span><span class="fu">WaterfallPlot</span><span class="op">(</span></span>
<span>  <span class="va">pbmc</span>, group.by <span class="op">=</span> <span class="st">"cluster"</span>, features <span class="op">=</span> <span class="va">genes</span>,</span>
<span>  ident.1 <span class="op">=</span> <span class="st">"Mono CD14"</span>, ident.2 <span class="op">=</span> <span class="st">"CD8 T cell"</span>, length <span class="op">=</span> <span class="st">"logFC"</span>,</span>
<span>  top.n <span class="op">=</span> <span class="fl">20</span><span class="op">)</span></span></code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Yichao Hua.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

